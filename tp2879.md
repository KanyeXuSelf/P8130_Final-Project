Writing Scores Analysis
================

## Import and Clean the Data

``` r
writing = read.csv(file = "./data/Project_1_data.csv") |> 
  janitor::clean_names() |> 
  mutate(across(where(is.character), ~na_if(.x, "")))
  
writing = writing |> 
  filter(!is.na(writing_score)) |> 
  drop_na()

head(writing)
```

    ##   gender ethnic_group        parent_educ   lunch_type test_prep
    ## 1 female      group B    master's degree     standard      none
    ## 2   male      group C       some college     standard      none
    ## 3 female      group B associate's degree     standard      none
    ## 4 female      group B       some college     standard completed
    ## 5   male      group B       some college free/reduced      none
    ## 6   male      group D        high school free/reduced completed
    ##   parent_marital_status practice_sport is_first_child nr_siblings
    ## 1                single      sometimes            yes           4
    ## 2               married      sometimes            yes           0
    ## 3               married      regularly            yes           1
    ## 4               widowed          never             no           1
    ## 5               married      sometimes            yes           1
    ## 6                single      sometimes             no           3
    ##   transport_means wkly_study_hours math_score reading_score writing_score
    ## 1      school_bus              < 5         87            93            91
    ## 2      school_bus           10-May         76            78            75
    ## 3      school_bus           10-May         73            84            79
    ## 4         private           10-May         85            93            89
    ## 5         private             > 10         41            43            39
    ## 6         private             > 10         65            64            68

## Descriptive Statistics

``` r
summary(writing$writing_score)
```

    ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    ##    10.0    58.0    69.0    68.9    79.0   100.0

``` r
var(writing$writing_score)
```

    ## [1] 241.8025

``` r
sd(writing$writing_score)
```

    ## [1] 15.55

## Percentiles

``` r
percentiles = quantile(writing$writing_score, probs = seq(0.1, 1, by = 0.1))

print(percentiles)
```

    ##   10%   20%   30%   40%   50%   60%   70%   80%   90%  100% 
    ##  49.0  55.2  60.0  65.0  69.0  74.0  78.0  83.0  89.0 100.0

## Visualizations

``` r
ggplot(writing, aes(x = writing_score)) +
  geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
  labs(
    title = "Distribution of Writing Scores",
    x = "Score",
    y = "Frequency")
```

![](tp2879_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

``` r
ggplot(writing, aes(x = writing_score)) +
  geom_density(fill = "purple", alpha = 0.5) +
  labs(
    title = "Density Plot of Writing Scores",
    x = "Writing Score",
    y = "Density")
```

![](tp2879_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

``` r
ggplot(writing, aes(x = gender, y = writing_score)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Writing Scores by Gender",
    x = "Gender",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

``` r
ggplot(writing, aes(x = ethnic_group, y = writing_score)) +
  geom_boxplot(fill = "lightgreen") +
  labs(
    title = "Writing Scores by Ethnic Group",
    x = "Ethnic Group",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->

``` r
ggplot(writing, aes(x = parent_educ, y = writing_score)) +
  geom_boxplot(fill = "lightpink") +
  labs(
    title = "Writing Scores by Parent Education",
    x = "Parent Education",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->

``` r
ggplot(writing, aes(x = lunch_type, y = writing_score)) +
  geom_boxplot(fill = "yellow") +
  labs(
    title = "Writing Scores by Lunch Type",
    x = "Lunch Type",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->

``` r
ggplot(writing, aes(x = test_prep, y = writing_score)) +
  geom_boxplot(fill = "orange") +
  labs(
    title = "Writing Scores by Test Prep",
    x = "Test Prep",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->

``` r
ggplot(writing, aes(x = parent_marital_status, y = writing_score)) +
  geom_boxplot(fill = "navyblue") +
  labs(
    title = "Writing Scores by Parent Marital Status",
    x = "Parent Marital Status",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-11-1.png)<!-- -->

``` r
ggplot(writing, aes(x = practice_sport, y = writing_score)) +
  geom_boxplot(fill = "thistle") +
  labs(
    title = "Writing Scores by Practice Sport",
    x = "Practice Sport",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-12-1.png)<!-- -->

``` r
ggplot(writing, aes(x = is_first_child, y = writing_score)) +
  geom_boxplot(fill = "sienna") +
  labs(
    title = "Writing Scores by First Child",
    x = "First Child",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-13-1.png)<!-- -->

``` r
ggplot(writing, aes(x = nr_siblings, y = writing_score)) +
  geom_boxplot(fill = "salmon") +
  labs(
    title = "Writing Scores by Number of Siblings",
    x = "Number of Siblings",
    y = "Writing Score")
```

    ## Warning: Continuous x aesthetic
    ## â„¹ did you forget `aes(group = ...)`?

![](tp2879_files/figure-gfm/unnamed-chunk-14-1.png)<!-- -->

``` r
ggplot(writing, aes(x = transport_means, y = writing_score)) +
  geom_boxplot(fill = "royalblue") +
  labs(
    title = "Writing Scores by Transportation Means",
    x = "Transportation Means",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-15-1.png)<!-- -->

``` r
ggplot(writing, aes(x = wkly_study_hours, y = writing_score)) +
  geom_boxplot(fill = "orchid") +
  labs(
    title = "Writing Scores by Weekly Study Hours",
    x = "Weekly Study Hours",
    y = "Writing Score")
```

![](tp2879_files/figure-gfm/unnamed-chunk-16-1.png)<!-- -->

## Statistical Testing

### Linear Regression

``` r
lm_model = lm(writing_score ~ gender + ethnic_group + parent_educ + lunch_type + test_prep + parent_marital_status + practice_sport + is_first_child + nr_siblings + transport_means + wkly_study_hours, data = writing)

summary(lm_model)
```

    ## 
    ## Call:
    ## lm(formula = writing_score ~ gender + ethnic_group + parent_educ + 
    ##     lunch_type + test_prep + parent_marital_status + practice_sport + 
    ##     is_first_child + nr_siblings + transport_means + wkly_study_hours, 
    ##     data = writing)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -46.922  -8.043   1.071   8.811  26.214 
    ## 
    ## Coefficients:
    ##                               Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)                  63.939541   3.530228  18.112  < 2e-16 ***
    ## gendermale                   -9.268845   1.064760  -8.705  < 2e-16 ***
    ## ethnic_groupgroup B          -1.372239   2.163560  -0.634 0.526175    
    ## ethnic_groupgroup C           0.005008   2.071256   0.002 0.998072    
    ## ethnic_groupgroup D           5.010576   2.084123   2.404 0.016531 *  
    ## ethnic_groupgroup E           6.018419   2.284980   2.634 0.008673 ** 
    ## parent_educbachelor's degree  3.086897   1.890798   1.633 0.103113    
    ## parent_educhigh school       -6.361777   1.633119  -3.895 0.000110 ***
    ## parent_educmaster's degree    5.581496   2.350617   2.374 0.017907 *  
    ## parent_educsome college      -1.791985   1.641742  -1.092 0.275513    
    ## parent_educsome high school  -6.130783   1.657904  -3.698 0.000239 ***
    ## lunch_typestandard            9.390698   1.100772   8.531  < 2e-16 ***
    ## test_prepnone                -8.754351   1.122889  -7.796 3.09e-14 ***
    ## parent_marital_statusmarried  5.246610   1.512157   3.470 0.000561 ***
    ## parent_marital_statussingle   2.144248   1.725778   1.242 0.214575    
    ## parent_marital_statuswidowed  6.877832   3.564779   1.929 0.054184 .  
    ## practice_sportregularly       1.606102   1.781092   0.902 0.367574    
    ## practice_sportsometimes       1.674659   1.724312   0.971 0.331863    
    ## is_first_childyes             1.045414   1.133850   0.922 0.356921    
    ## nr_siblings                   0.546033   0.359485   1.519 0.129340    
    ## transport_meansschool_bus     0.240107   1.087508   0.221 0.825338    
    ## wkly_study_hours> 10          1.188892   1.640324   0.725 0.468881    
    ## wkly_study_hours10-May        2.802323   1.255870   2.231 0.026048 *  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 12.65 on 564 degrees of freedom
    ## Multiple R-squared:  0.3634, Adjusted R-squared:  0.3385 
    ## F-statistic: 14.63 on 22 and 564 DF,  p-value: < 2.2e-16

### Correlation Matrix

``` r
writing = writing |> 
  mutate(across(c(gender, ethnic_group, parent_educ, lunch_type, test_prep, parent_marital_status, practice_sport, is_first_child, nr_siblings, transport_means, wkly_study_hours), as.factor))

writing_encoded = writing |> 
  mutate(across(where(is.factor), as.numeric))

cor_writing = writing_encoded |> 
  select_if(is.numeric)

cor_matrix = cor(cor_writing, use = "complete.obs", method = "pearson")

print(cor_matrix)
```

    ##                             gender ethnic_group  parent_educ   lunch_type
    ## gender                 1.000000000  0.005079202 -0.021259218  0.053363154
    ## ethnic_group           0.005079202  1.000000000 -0.008102497  0.039116746
    ## parent_educ           -0.021259218 -0.008102497  1.000000000 -0.009371435
    ## lunch_type             0.053363154  0.039116746 -0.009371435  1.000000000
    ## test_prep             -0.040129121 -0.017865520  0.017867033  0.029888578
    ## parent_marital_status -0.033438606 -0.027559843 -0.026242055 -0.034558508
    ## practice_sport        -0.014763219 -0.024419470 -0.008094825 -0.016807118
    ## is_first_child         0.014328248  0.001128474  0.021101207  0.012326372
    ## nr_siblings           -0.034606638 -0.025868769 -0.054044212  0.001872997
    ## transport_means        0.014795263 -0.030533290 -0.072615332  0.011967843
    ## wkly_study_hours      -0.016311032  0.001006745  0.001546539  0.047556263
    ## math_score             0.183344700  0.226466399 -0.109100845  0.383179573
    ## reading_score         -0.234755011  0.163739469 -0.107854086  0.256612463
    ## writing_score         -0.279943857  0.194208347 -0.116739243  0.271475729
    ##                         test_prep parent_marital_status practice_sport
    ## gender                -0.04012912          -0.033438606   -0.014763219
    ## ethnic_group          -0.01786552          -0.027559843   -0.024419470
    ## parent_educ            0.01786703          -0.026242055   -0.008094825
    ## lunch_type             0.02988858          -0.034558508   -0.016807118
    ## test_prep              1.00000000          -0.033163435   -0.033407781
    ## parent_marital_status -0.03316343           1.000000000    0.022413063
    ## practice_sport        -0.03340778           0.022413063    1.000000000
    ## is_first_child        -0.05340039          -0.086675589    0.011698968
    ## nr_siblings           -0.04798028           0.044236769    0.004110089
    ## transport_means        0.07196028           0.006372934    0.050366165
    ## wkly_study_hours      -0.04568828          -0.015446923    0.013143838
    ## math_score            -0.16443773           0.016759179   -0.001323171
    ## reading_score         -0.19622698           0.026315081    0.029274208
    ## writing_score         -0.26054207           0.044087663    0.033872175
    ##                       is_first_child  nr_siblings transport_means
    ## gender                   0.014328248 -0.034606638     0.014795263
    ## ethnic_group             0.001128474 -0.025868769    -0.030533290
    ## parent_educ              0.021101207 -0.054044212    -0.072615332
    ## lunch_type               0.012326372  0.001872997     0.011967843
    ## test_prep               -0.053400392 -0.047980280     0.071960279
    ## parent_marital_status   -0.086675589  0.044236769     0.006372934
    ## practice_sport           0.011698968  0.004110089     0.050366165
    ## is_first_child           1.000000000 -0.083833027     0.008167280
    ## nr_siblings             -0.083833027  1.000000000    -0.002383219
    ## transport_means          0.008167280 -0.002383219     1.000000000
    ## wkly_study_hours         0.039165127 -0.038208669     0.001104249
    ## math_score               0.029512768  0.063578248     0.001491884
    ## reading_score            0.038714243  0.044769867     0.011728627
    ## writing_score            0.025949378  0.062888068     0.002106993
    ##                       wkly_study_hours   math_score reading_score writing_score
    ## gender                    -0.016311032  0.183344700   -0.23475501  -0.279943857
    ## ethnic_group               0.001006745  0.226466399    0.16373947   0.194208347
    ## parent_educ                0.001546539 -0.109100845   -0.10785409  -0.116739243
    ## lunch_type                 0.047556263  0.383179573    0.25661246   0.271475729
    ## test_prep                 -0.045688278 -0.164437735   -0.19622698  -0.260542074
    ## parent_marital_status     -0.015446923  0.016759179    0.02631508   0.044087663
    ## practice_sport             0.013143838 -0.001323171    0.02927421   0.033872175
    ## is_first_child             0.039165127  0.029512768    0.03871424   0.025949378
    ## nr_siblings               -0.038208669  0.063578248    0.04476987   0.062888068
    ## transport_means            0.001104249  0.001491884    0.01172863   0.002106993
    ## wkly_study_hours           1.000000000  0.108768508    0.09826373   0.103835459
    ## math_score                 0.108768508  1.000000000    0.82017293   0.812460476
    ## reading_score              0.098263733  0.820172926    1.00000000   0.957728382
    ## writing_score              0.103835459  0.812460476    0.95772838   1.000000000

``` r
cor_table = knitr::kable(cor_matrix, format = "markdown")

print(cor_table)
```

    ## 
    ## 
    ## |                      |     gender| ethnic_group| parent_educ| lunch_type|  test_prep| parent_marital_status| practice_sport| is_first_child| nr_siblings| transport_means| wkly_study_hours| math_score| reading_score| writing_score|
    ## |:---------------------|----------:|------------:|-----------:|----------:|----------:|---------------------:|--------------:|--------------:|-----------:|---------------:|----------------:|----------:|-------------:|-------------:|
    ## |gender                |  1.0000000|    0.0050792|  -0.0212592|  0.0533632| -0.0401291|            -0.0334386|     -0.0147632|      0.0143282|  -0.0346066|       0.0147953|       -0.0163110|  0.1833447|    -0.2347550|    -0.2799439|
    ## |ethnic_group          |  0.0050792|    1.0000000|  -0.0081025|  0.0391167| -0.0178655|            -0.0275598|     -0.0244195|      0.0011285|  -0.0258688|      -0.0305333|        0.0010067|  0.2264664|     0.1637395|     0.1942083|
    ## |parent_educ           | -0.0212592|   -0.0081025|   1.0000000| -0.0093714|  0.0178670|            -0.0262421|     -0.0080948|      0.0211012|  -0.0540442|      -0.0726153|        0.0015465| -0.1091008|    -0.1078541|    -0.1167392|
    ## |lunch_type            |  0.0533632|    0.0391167|  -0.0093714|  1.0000000|  0.0298886|            -0.0345585|     -0.0168071|      0.0123264|   0.0018730|       0.0119678|        0.0475563|  0.3831796|     0.2566125|     0.2714757|
    ## |test_prep             | -0.0401291|   -0.0178655|   0.0178670|  0.0298886|  1.0000000|            -0.0331634|     -0.0334078|     -0.0534004|  -0.0479803|       0.0719603|       -0.0456883| -0.1644377|    -0.1962270|    -0.2605421|
    ## |parent_marital_status | -0.0334386|   -0.0275598|  -0.0262421| -0.0345585| -0.0331634|             1.0000000|      0.0224131|     -0.0866756|   0.0442368|       0.0063729|       -0.0154469|  0.0167592|     0.0263151|     0.0440877|
    ## |practice_sport        | -0.0147632|   -0.0244195|  -0.0080948| -0.0168071| -0.0334078|             0.0224131|      1.0000000|      0.0116990|   0.0041101|       0.0503662|        0.0131438| -0.0013232|     0.0292742|     0.0338722|
    ## |is_first_child        |  0.0143282|    0.0011285|   0.0211012|  0.0123264| -0.0534004|            -0.0866756|      0.0116990|      1.0000000|  -0.0838330|       0.0081673|        0.0391651|  0.0295128|     0.0387142|     0.0259494|
    ## |nr_siblings           | -0.0346066|   -0.0258688|  -0.0540442|  0.0018730| -0.0479803|             0.0442368|      0.0041101|     -0.0838330|   1.0000000|      -0.0023832|       -0.0382087|  0.0635782|     0.0447699|     0.0628881|
    ## |transport_means       |  0.0147953|   -0.0305333|  -0.0726153|  0.0119678|  0.0719603|             0.0063729|      0.0503662|      0.0081673|  -0.0023832|       1.0000000|        0.0011042|  0.0014919|     0.0117286|     0.0021070|
    ## |wkly_study_hours      | -0.0163110|    0.0010067|   0.0015465|  0.0475563| -0.0456883|            -0.0154469|      0.0131438|      0.0391651|  -0.0382087|       0.0011042|        1.0000000|  0.1087685|     0.0982637|     0.1038355|
    ## |math_score            |  0.1833447|    0.2264664|  -0.1091008|  0.3831796| -0.1644377|             0.0167592|     -0.0013232|      0.0295128|   0.0635782|       0.0014919|        0.1087685|  1.0000000|     0.8201729|     0.8124605|
    ## |reading_score         | -0.2347550|    0.1637395|  -0.1078541|  0.2566125| -0.1962270|             0.0263151|      0.0292742|      0.0387142|   0.0447699|       0.0117286|        0.0982637|  0.8201729|     1.0000000|     0.9577284|
    ## |writing_score         | -0.2799439|    0.1942083|  -0.1167392|  0.2714757| -0.2605421|             0.0440877|      0.0338722|      0.0259494|   0.0628881|       0.0021070|        0.1038355|  0.8124605|     0.9577284|     1.0000000|

### Backward Elimination Method

``` r
full_model = lm(writing_score ~ gender + ethnic_group + parent_educ + lunch_type + test_prep + parent_marital_status + practice_sport + is_first_child + nr_siblings + transport_means + wkly_study_hours, data = writing)

backward_model = step(full_model, direction = "backward")
```

    ## Start:  AIC=3008.49
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + practice_sport + is_first_child + 
    ##     nr_siblings + transport_means + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - nr_siblings            7    1128.4  90577 3001.8
    ## - practice_sport         2     120.3  89569 3005.3
    ## - transport_means        1       5.9  89454 3006.5
    ## - is_first_child         1      55.0  89503 3006.8
    ## <none>                                89448 3008.5
    ## - wkly_study_hours       2     884.4  90333 3010.3
    ## - parent_marital_status  3    2375.1  91824 3017.9
    ## - ethnic_group           4    4578.6  94027 3029.8
    ## - parent_educ            5    8360.9  97809 3050.9
    ## - test_prep              1    9766.4  99215 3067.3
    ## - lunch_type             1   10949.7 100398 3074.3
    ## - gender                 1   12071.2 101520 3080.8
    ## 
    ## Step:  AIC=3001.85
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + practice_sport + is_first_child + 
    ##     transport_means + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - practice_sport         2     157.8  90735 2998.9
    ## - transport_means        1       8.3  90585 2999.9
    ## - is_first_child         1     102.2  90679 3000.5
    ## <none>                                90577 3001.8
    ## - wkly_study_hours       2     783.2  91360 3002.9
    ## - parent_marital_status  3    2533.3  93110 3012.0
    ## - ethnic_group           4    4850.5  95427 3024.5
    ## - parent_educ            5    8390.0  98967 3043.8
    ## - test_prep              1    9961.6 100538 3061.1
    ## - lunch_type             1   11681.1 102258 3071.1
    ## - gender                 1   12361.3 102938 3074.9
    ## 
    ## Step:  AIC=2998.87
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + is_first_child + transport_means + 
    ##     wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - transport_means        1      12.5  90747 2996.9
    ## - is_first_child         1      93.3  90828 2997.5
    ## <none>                                90735 2998.9
    ## - wkly_study_hours       2     804.6  91539 3000.1
    ## - parent_marital_status  3    2553.4  93288 3009.2
    ## - ethnic_group           4    4843.2  95578 3021.4
    ## - parent_educ            5    8318.4  99053 3040.4
    ## - test_prep              1   10110.5 100845 3058.9
    ## - lunch_type             1   11615.2 102350 3067.6
    ## - gender                 1   12381.3 103116 3072.0
    ## 
    ## Step:  AIC=2996.95
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + is_first_child + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - is_first_child         1      94.7  90842 2995.6
    ## <none>                                90747 2996.9
    ## - wkly_study_hours       2     806.7  91554 2998.2
    ## - parent_marital_status  3    2568.2  93315 3007.3
    ## - ethnic_group           4    4836.0  95583 3019.4
    ## - parent_educ            5    8384.8  99132 3038.8
    ## - test_prep              1   10125.5 100873 3057.1
    ## - lunch_type             1   11624.0 102371 3065.7
    ## - gender                 1   12372.4 103119 3070.0
    ## 
    ## Step:  AIC=2995.57
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## <none>                                90842 2995.6
    ## - wkly_study_hours       2     827.3  91669 2996.9
    ## - parent_marital_status  3    2508.2  93350 3005.6
    ## - ethnic_group           4    4803.2  95645 3017.8
    ## - parent_educ            5    8364.6  99206 3037.3
    ## - test_prep              1   10274.5 101116 3056.5
    ## - lunch_type             1   11644.0 102486 3064.4
    ## - gender                 1   12344.4 103186 3068.4

``` r
summary(backward_model)
```

    ## 
    ## Call:
    ## lm(formula = writing_score ~ gender + ethnic_group + parent_educ + 
    ##     lunch_type + test_prep + parent_marital_status + wkly_study_hours, 
    ##     data = writing)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -45.977  -7.958   0.963   9.188  26.159 
    ## 
    ## Coefficients:
    ##                              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)                  67.57375    2.91348  23.194  < 2e-16 ***
    ## gendermale                   -9.33994    1.06218  -8.793  < 2e-16 ***
    ## ethnic_groupgroup B          -1.46879    2.15698  -0.681 0.496180    
    ## ethnic_groupgroup C           0.06504    2.06421   0.032 0.974877    
    ## ethnic_groupgroup D           4.93524    2.07666   2.377 0.017806 *  
    ## ethnic_groupgroup E           5.88238    2.27782   2.582 0.010059 *  
    ## parent_educbachelor's degree  2.94629    1.88747   1.561 0.119086    
    ## parent_educhigh school       -6.21892    1.62236  -3.833 0.000141 ***
    ## parent_educmaster's degree    5.35114    2.33241   2.294 0.022139 *  
    ## parent_educsome college      -1.79878    1.63279  -1.102 0.271075    
    ## parent_educsome high school  -6.28800    1.65187  -3.807 0.000156 ***
    ## lunch_typestandard            9.38554    1.09899   8.540  < 2e-16 ***
    ## test_prepnone                -8.92515    1.11256  -8.022 5.96e-15 ***
    ## parent_marital_statusmarried  5.28139    1.50141   3.518 0.000470 ***
    ## parent_marital_statussingle   2.20131    1.71297   1.285 0.199286    
    ## parent_marital_statuswidowed  6.89594    3.54724   1.944 0.052384 .  
    ## wkly_study_hours> 10          1.35009    1.63558   0.825 0.409463    
    ## wkly_study_hours10-May        2.80033    1.25235   2.236 0.025735 *  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 12.64 on 569 degrees of freedom
    ## Multiple R-squared:  0.3589, Adjusted R-squared:  0.3397 
    ## F-statistic: 18.74 on 17 and 569 DF,  p-value: < 2.2e-16

Forward Selection

``` r
empty_model = lm(writing_score ~ 1, data = writing)

forward_model = step(empty_model, 
                     scope = list(lower = empty_model, 
                                  upper = ~ gender + ethnic_group + parent_educ + lunch_type + test_prep + parent_marital_status + practice_sport + is_first_child + nr_siblings + transport_means + wkly_study_hours), direction = "forward")
```

    ## Start:  AIC=3222.53
    ## writing_score ~ 1
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## + gender                 1   11104.5 130592 3176.6
    ## + lunch_type             1   10442.9 131253 3179.6
    ## + test_prep              1    9618.7 132078 3183.3
    ## + parent_educ            5   11133.9 130562 3184.5
    ## + ethnic_group           4    5484.2 136212 3207.4
    ## + wkly_study_hours       2    1531.9 140164 3220.1
    ## + parent_marital_status  3    1929.1 139767 3220.5
    ## <none>                               141696 3222.5
    ## + is_first_child         1      95.4 141601 3224.1
    ## + transport_means        1       0.6 141696 3224.5
    ## + practice_sport         2     162.8 141533 3225.9
    ## + nr_siblings            7    2379.4 139317 3226.6
    ## 
    ## Step:  AIC=3176.62
    ## writing_score ~ gender
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## + lunch_type             1   11657.0 118935 3123.7
    ## + test_prep              1   10482.9 120109 3129.5
    ## + parent_educ            5    9612.1 120980 3141.7
    ## + ethnic_group           4    5921.4 124670 3157.4
    ## + parent_marital_status  3    2060.8 128531 3173.3
    ## + wkly_study_hours       2    1464.7 129127 3174.0
    ## <none>                               130592 3176.6
    ## + is_first_child         1     127.2 130465 3178.0
    ## + nr_siblings            7    2712.5 127879 3178.3
    ## + transport_means        1       5.5 130586 3178.6
    ## + practice_sport         2     125.5 130466 3180.1
    ## 
    ## Step:  AIC=3123.74
    ## writing_score ~ gender + lunch_type
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## + test_prep              1   11216.2 107719 3067.6
    ## + parent_educ            5    9909.5 109025 3082.7
    ## + ethnic_group           4    5256.1 113679 3105.2
    ## + parent_marital_status  3    2028.6 116906 3119.6
    ## + wkly_study_hours       2    1162.9 117772 3122.0
    ## <none>                               118935 3123.7
    ## + is_first_child         1     100.6 118834 3125.2
    ## + transport_means        1       1.3 118933 3125.7
    ## + practice_sport         2     179.9 118755 3126.8
    ## + nr_siblings            7    1869.1 117066 3128.4
    ## 
    ## Step:  AIC=3067.59
    ## writing_score ~ gender + lunch_type + test_prep
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## + parent_educ            5    9190.5  98528 3025.2
    ## + ethnic_group           4    5091.3 102627 3047.2
    ## + parent_marital_status  3    2161.1 105557 3061.7
    ## + wkly_study_hours       2     743.3 106975 3067.5
    ## <none>                               107719 3067.6
    ## + transport_means        1      77.9 107641 3069.2
    ## + is_first_child         1      19.3 107699 3069.5
    ## + practice_sport         2      92.7 107626 3071.1
    ## + nr_siblings            7    1564.9 106154 3073.0
    ## 
    ## Step:  AIC=3025.24
    ## writing_score ~ gender + lunch_type + test_prep + parent_educ
    ## 
    ##                         Df Sum of Sq   RSS    AIC
    ## + ethnic_group           4    4313.2 94215 3007.0
    ## + parent_marital_status  3    1944.7 96583 3019.5
    ## + wkly_study_hours       2     974.0 97554 3023.4
    ## <none>                               98528 3025.2
    ## + is_first_child         1      34.2 98494 3027.0
    ## + transport_means        1      18.0 98510 3027.1
    ## + practice_sport         2     177.4 98351 3028.2
    ## + nr_siblings            7    1513.7 97014 3030.2
    ## 
    ## Step:  AIC=3006.97
    ## writing_score ~ gender + lunch_type + test_prep + parent_educ + 
    ##     ethnic_group
    ## 
    ##                         Df Sum of Sq   RSS    AIC
    ## + parent_marital_status  3   2545.71 91669 2996.9
    ## + wkly_study_hours       2    864.83 93350 3005.6
    ## <none>                               94215 3007.0
    ## + is_first_child         1     48.28 94167 3008.7
    ## + transport_means        1     32.92 94182 3008.8
    ## + practice_sport         2    195.29 94020 3009.8
    ## + nr_siblings            7   1263.49 92951 3013.0
    ## 
    ## Step:  AIC=2996.89
    ## writing_score ~ gender + lunch_type + test_prep + parent_educ + 
    ##     ethnic_group + parent_marital_status
    ## 
    ##                    Df Sum of Sq   RSS    AIC
    ## + wkly_study_hours  2    827.32 90842 2995.6
    ## <none>                          91669 2996.9
    ## + is_first_child    1    115.33 91554 2998.2
    ## + transport_means   1     16.41 91653 2998.8
    ## + practice_sport    2    173.57 91496 2999.8
    ## + nr_siblings       7   1121.28 90548 3003.7
    ## 
    ## Step:  AIC=2995.57
    ## writing_score ~ gender + lunch_type + test_prep + parent_educ + 
    ##     ethnic_group + parent_marital_status + wkly_study_hours
    ## 
    ##                   Df Sum of Sq   RSS    AIC
    ## <none>                         90842 2995.6
    ## + is_first_child   1     94.72 90747 2996.9
    ## + transport_means  1     13.98 90828 2997.5
    ## + practice_sport   2    153.26 90689 2998.6
    ## + nr_siblings      7   1212.90 89629 3001.7

``` r
summary(forward_model)
```

    ## 
    ## Call:
    ## lm(formula = writing_score ~ gender + lunch_type + test_prep + 
    ##     parent_educ + ethnic_group + parent_marital_status + wkly_study_hours, 
    ##     data = writing)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -45.977  -7.958   0.963   9.188  26.159 
    ## 
    ## Coefficients:
    ##                              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)                  67.57375    2.91348  23.194  < 2e-16 ***
    ## gendermale                   -9.33994    1.06218  -8.793  < 2e-16 ***
    ## lunch_typestandard            9.38554    1.09899   8.540  < 2e-16 ***
    ## test_prepnone                -8.92515    1.11256  -8.022 5.96e-15 ***
    ## parent_educbachelor's degree  2.94629    1.88747   1.561 0.119086    
    ## parent_educhigh school       -6.21892    1.62236  -3.833 0.000141 ***
    ## parent_educmaster's degree    5.35114    2.33241   2.294 0.022139 *  
    ## parent_educsome college      -1.79878    1.63279  -1.102 0.271075    
    ## parent_educsome high school  -6.28800    1.65187  -3.807 0.000156 ***
    ## ethnic_groupgroup B          -1.46879    2.15698  -0.681 0.496180    
    ## ethnic_groupgroup C           0.06504    2.06421   0.032 0.974877    
    ## ethnic_groupgroup D           4.93524    2.07666   2.377 0.017806 *  
    ## ethnic_groupgroup E           5.88238    2.27782   2.582 0.010059 *  
    ## parent_marital_statusmarried  5.28139    1.50141   3.518 0.000470 ***
    ## parent_marital_statussingle   2.20131    1.71297   1.285 0.199286    
    ## parent_marital_statuswidowed  6.89594    3.54724   1.944 0.052384 .  
    ## wkly_study_hours> 10          1.35009    1.63558   0.825 0.409463    
    ## wkly_study_hours10-May        2.80033    1.25235   2.236 0.025735 *  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 12.64 on 569 degrees of freedom
    ## Multiple R-squared:  0.3589, Adjusted R-squared:  0.3397 
    ## F-statistic: 18.74 on 17 and 569 DF,  p-value: < 2.2e-16

### Stepwise Method (stepAIC)

``` r
null_model = lm(writing_score ~ 1, data = writing)

stepwise_model = stepAIC(full_model, direction = "both", trace = TRUE)
```

    ## Start:  AIC=3008.49
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + practice_sport + is_first_child + 
    ##     nr_siblings + transport_means + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - nr_siblings            7    1128.4  90577 3001.8
    ## - practice_sport         2     120.3  89569 3005.3
    ## - transport_means        1       5.9  89454 3006.5
    ## - is_first_child         1      55.0  89503 3006.8
    ## <none>                                89448 3008.5
    ## - wkly_study_hours       2     884.4  90333 3010.3
    ## - parent_marital_status  3    2375.1  91824 3017.9
    ## - ethnic_group           4    4578.6  94027 3029.8
    ## - parent_educ            5    8360.9  97809 3050.9
    ## - test_prep              1    9766.4  99215 3067.3
    ## - lunch_type             1   10949.7 100398 3074.3
    ## - gender                 1   12071.2 101520 3080.8
    ## 
    ## Step:  AIC=3001.85
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + practice_sport + is_first_child + 
    ##     transport_means + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - practice_sport         2     157.8  90735 2998.9
    ## - transport_means        1       8.3  90585 2999.9
    ## - is_first_child         1     102.2  90679 3000.5
    ## <none>                                90577 3001.8
    ## - wkly_study_hours       2     783.2  91360 3002.9
    ## + nr_siblings            7    1128.4  89448 3008.5
    ## - parent_marital_status  3    2533.3  93110 3012.0
    ## - ethnic_group           4    4850.5  95427 3024.5
    ## - parent_educ            5    8390.0  98967 3043.8
    ## - test_prep              1    9961.6 100538 3061.1
    ## - lunch_type             1   11681.1 102258 3071.1
    ## - gender                 1   12361.3 102938 3074.9
    ## 
    ## Step:  AIC=2998.87
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + is_first_child + transport_means + 
    ##     wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - transport_means        1      12.5  90747 2996.9
    ## - is_first_child         1      93.3  90828 2997.5
    ## <none>                                90735 2998.9
    ## - wkly_study_hours       2     804.6  91539 3000.1
    ## + practice_sport         2     157.8  90577 3001.8
    ## + nr_siblings            7    1165.8  89569 3005.3
    ## - parent_marital_status  3    2553.4  93288 3009.2
    ## - ethnic_group           4    4843.2  95578 3021.4
    ## - parent_educ            5    8318.4  99053 3040.4
    ## - test_prep              1   10110.5 100845 3058.9
    ## - lunch_type             1   11615.2 102350 3067.6
    ## - gender                 1   12381.3 103116 3072.0
    ## 
    ## Step:  AIC=2996.95
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + is_first_child + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## - is_first_child         1      94.7  90842 2995.6
    ## <none>                                90747 2996.9
    ## - wkly_study_hours       2     806.7  91554 2998.2
    ## + transport_means        1      12.5  90735 2998.9
    ## + practice_sport         2     162.0  90585 2999.9
    ## + nr_siblings            7    1169.0  89578 3003.3
    ## - parent_marital_status  3    2568.2  93315 3007.3
    ## - ethnic_group           4    4836.0  95583 3019.4
    ## - parent_educ            5    8384.8  99132 3038.8
    ## - test_prep              1   10125.5 100873 3057.1
    ## - lunch_type             1   11624.0 102371 3065.7
    ## - gender                 1   12372.4 103119 3070.0
    ## 
    ## Step:  AIC=2995.57
    ## writing_score ~ gender + ethnic_group + parent_educ + lunch_type + 
    ##     test_prep + parent_marital_status + wkly_study_hours
    ## 
    ##                         Df Sum of Sq    RSS    AIC
    ## <none>                                90842 2995.6
    ## - wkly_study_hours       2     827.3  91669 2996.9
    ## + is_first_child         1      94.7  90747 2996.9
    ## + transport_means        1      14.0  90828 2997.5
    ## + practice_sport         2     153.3  90689 2998.6
    ## + nr_siblings            7    1212.9  89629 3001.7
    ## - parent_marital_status  3    2508.2  93350 3005.6
    ## - ethnic_group           4    4803.2  95645 3017.8
    ## - parent_educ            5    8364.6  99206 3037.3
    ## - test_prep              1   10274.5 101116 3056.5
    ## - lunch_type             1   11644.0 102486 3064.4
    ## - gender                 1   12344.4 103186 3068.4

``` r
summary(stepwise_model)
```

    ## 
    ## Call:
    ## lm(formula = writing_score ~ gender + ethnic_group + parent_educ + 
    ##     lunch_type + test_prep + parent_marital_status + wkly_study_hours, 
    ##     data = writing)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -45.977  -7.958   0.963   9.188  26.159 
    ## 
    ## Coefficients:
    ##                              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)                  67.57375    2.91348  23.194  < 2e-16 ***
    ## gendermale                   -9.33994    1.06218  -8.793  < 2e-16 ***
    ## ethnic_groupgroup B          -1.46879    2.15698  -0.681 0.496180    
    ## ethnic_groupgroup C           0.06504    2.06421   0.032 0.974877    
    ## ethnic_groupgroup D           4.93524    2.07666   2.377 0.017806 *  
    ## ethnic_groupgroup E           5.88238    2.27782   2.582 0.010059 *  
    ## parent_educbachelor's degree  2.94629    1.88747   1.561 0.119086    
    ## parent_educhigh school       -6.21892    1.62236  -3.833 0.000141 ***
    ## parent_educmaster's degree    5.35114    2.33241   2.294 0.022139 *  
    ## parent_educsome college      -1.79878    1.63279  -1.102 0.271075    
    ## parent_educsome high school  -6.28800    1.65187  -3.807 0.000156 ***
    ## lunch_typestandard            9.38554    1.09899   8.540  < 2e-16 ***
    ## test_prepnone                -8.92515    1.11256  -8.022 5.96e-15 ***
    ## parent_marital_statusmarried  5.28139    1.50141   3.518 0.000470 ***
    ## parent_marital_statussingle   2.20131    1.71297   1.285 0.199286    
    ## parent_marital_statuswidowed  6.89594    3.54724   1.944 0.052384 .  
    ## wkly_study_hours> 10          1.35009    1.63558   0.825 0.409463    
    ## wkly_study_hours10-May        2.80033    1.25235   2.236 0.025735 *  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 12.64 on 569 degrees of freedom
    ## Multiple R-squared:  0.3589, Adjusted R-squared:  0.3397 
    ## F-statistic: 18.74 on 17 and 569 DF,  p-value: < 2.2e-16
